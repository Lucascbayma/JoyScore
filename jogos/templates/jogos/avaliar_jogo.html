{% extends 'base.html' %}
{% load static %} 

{% block title %}avaliar - JoyScore{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'jogos/css/avaliar.css' %}"> 
{% endblock %}

{% block content %}
<section class="game-container">
    
    <div class="cover">
        <img src="{{jogo.background_image}}" alt="Capa do Jogo" id="game-cover">
    </div>

    <div class="game-info">
        
        <div class="title-section">
            <h1 id="game-title">{{jogo.titulo}}</h1>
            
            <a href="{% url 'jogos:adicionar_biblioteca' jogo.id %}" 
               class="add-btn {% if esta_na_biblioteca %} added {% endif %}" 
               title="{% if esta_na_biblioteca %}Remover da biblioteca{% else %}Adicionar à biblioteca{% endif %}"
               aria-label="{% if esta_na_biblioteca %}Remover {{jogo.titulo}}{% else %}Adicionar {{jogo.titulo}}{% endif %}">
                
                <i class="fas {% if esta_na_biblioteca %}fa-check{% else %}fa-plus{% endif %}"></i>
            </a>

            </div>

        <dl class="details">
            <dt>Gênero:</dt>
            <dd id="game-genre">{{jogo.genero}}</dd>

            <dt>Desenvolvedor:</dt>
            <dd id="game-platforms">{{jogo.desenvolvedor}}</dd>
        </dl>
        
        <div class="description">
            <h2>Descrição</h2>
            <p id="game-description">
                {{jogo.descricao}}
            </p>
        </div>

        <section class="rating-section">
            {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    {% if 'removido' in message|lower or 'adicionado' in message|lower or 'sucesso' in message|lower %}
                        <p style="color: green; text-align: center;">{{ message }}</p>
                    {% else %}
                        <p style="color: red; text-align: center;">{{ message }}</p>
                    {% endif %}
                {% endfor %}
            </div>
            {% endif %}

            <h2>Avalie este jogo</h2>
            
            
            <form class="rating-form" method="POST">
                {% csrf_token %}
                
                <fieldset class="rating">
                    <legend class="sr-only">Avaliação de estrelas: 1 a 5</legend>

                    <input type="radio" id="star5" name="nota" value="5" aria-label="5 Estrelas" {% if avaliacao_existente.nota == 5 %}checked{% endif %}>
                    <label for="star5" class="star">★</label>
                    
                    <input type="radio" id="star4" name="nota" value="4" aria-label="4 Estrelas" {% if avaliacao_existente.nota == 4 %}checked{% endif %}>
                    <label for="star4" class="star">★</label>
                    
                    <input type="radio" id="star3" name="nota" value="3" aria-label="3 Estrelas" {% if avaliacao_existente.nota == 3 %}checked{% endif %}>
                    <label for="star3" class="star">★</label>
                    
                    <input type="radio" id="star2" name="nota" value="2" aria-label="2 Estrelas" {% if avaliacao_existente.nota == 2 %}checked{% endif %}>
                    <label for="star2" class="star">★</label>
                    
                    <input type="radio" id="star1" name="nota" value="1" aria-label="1 Estrela" {% if avaliacao_existente.nota == 1 %}checked{% endif %}>
                    <label for="star1" class="star">★</label>
                </fieldset>

                <div class="comment-field"> 
                    <label for="comment-text">Seu Comentário:</label> 
                    <textarea 
                        id="comment-text" 
                        name="comentario" 
                        rows="4" 
                        placeholder="Escreva sua avaliação sobre o jogo aqui!"
                    >{{avaliacao_existente.comentario|default:''}}</textarea>
                </div>
                
                <button type="submit" name="acao" value="salvar" class="submit-rating">Salvar Avaliação</button>

            </form>
        </section>
        
      </div>
    </section>

{% endblock content %}

{% block extra_scripts %}
    {% endblock %}